<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WooCommerce: El Juego de la Tienda M√°gica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .task-tooltip {
            position: absolute;
            background-color: #1e40af;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        .task-tooltip.visible {
            opacity: 1;
        }
        .task-tooltip::after {
            content: '';
            position: absolute;
            top: 50%;
            left: -10px;
            margin-top: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: transparent #1e40af transparent transparent;
        }
        .mission-item.completed {
            text-decoration: line-through;
            color: #9ca3af;
        }
        .mission-item.completed .mission-icon {
            background-color: #22c55e;
            color: white;
        }
        .mission-item.active .mission-icon {
            background-color: #3b82f6;
            color: white;
        }
        .highlight-focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
            border-radius: 6px;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 text-white flex flex-col">
            <div class="p-4 text-2xl font-bold border-b border-gray-700">
                Tienda M√°gica ‚ú®
            </div>
            <nav class="flex-1 p-4 space-y-2">
                <a href="#" id="nav-dashboard" class="nav-link flex items-center p-2 rounded-lg bg-gray-900">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Escritorio
                </a>
                <a href="#" id="nav-products" class="nav-link flex items-center p-2 rounded-lg hover:bg-gray-700">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                    Productos
                </a>
                <a href="#" id="nav-coupons" class="nav-link flex items-center p-2 rounded-lg hover:bg-gray-700">
                     <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg>
                    Cupones
                </a>
                <a href="#" id="nav-plugins" class="nav-link flex items-center p-2 rounded-lg hover:bg-gray-700">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 16v-2m0-10v2M6 12H4m16 0h-2m-10 0h2M12 18a6 6 0 100-12 6 6 0 000 12z"></path></svg>
                    Plugins
                </a>
                 <a href="#" id="nav-orders" class="nav-link flex items-center p-2 rounded-lg hover:bg-gray-700">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    Pedidos
                </a>
                <a href="#" id="nav-customize" class="nav-link flex items-center p-2 rounded-lg hover:bg-gray-700">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                    Personalizar
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-8 overflow-y-auto">
            
            <!-- Dashboard View -->
            <div id="view-dashboard" class="view">
                <h1 class="text-3xl font-bold mb-6">Bienvenido a tu Tienda M√°gica</h1>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-xl font-semibold mb-4">Tus misiones para ser un Mago del Comercio</h2>
                    <p class="mb-6 text-gray-600">Completa estas tareas para configurar tu tienda y empezar a vender tus pociones y artefactos.</p>
                    <ul class="space-y-4">
                        <li id="mission-1" class="mission-item flex items-center active">
                            <div class="mission-icon flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold mr-4">1</div>
                            <span class="font-medium">Crea tu primer producto m√°gico</span>
                        </li>
                        <li id="mission-2" class="mission-item flex items-center">
                            <div class="mission-icon flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold mr-4">2</div>
                            <span class="font-medium">Atrae clientes con una oferta</span>
                        </li>
                        <li id="mission-3" class="mission-item flex items-center">
                            <div class="mission-icon flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold mr-4">3</div>
                            <span class="font-medium">Mejora tu tienda con un encantamiento (Plugin)</span>
                        </li>
                         <li id="mission-4" class="mission-item flex items-center">
                            <div class="mission-icon flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold mr-4">4</div>
                            <span class="font-medium">Gestiona tu primer pedido</span>
                        </li>
                        <li id="mission-5" class="mission-item flex items-center">
                            <div class="mission-icon flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-bold mr-4">5</div>
                            <span class="font-medium">Personaliza el escaparate</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Products View -->
            <div id="view-products" class="view hidden">
                <h1 class="text-3xl font-bold mb-6">A√±adir nuevo producto</h1>
                <div class="bg-white p-6 rounded-lg shadow-md relative">
                    <div class="space-y-6">
                        <div class="relative">
                            <label for="product-name" class="block text-sm font-medium text-gray-700">Nombre del producto</label>
                            <input type="text" id="product-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="relative">
                            <label for="product-description" class="block text-sm font-medium text-gray-700">Descripci√≥n</label>
                            <textarea id="product-description" rows="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>
                        <div class="relative">
                            <label for="product-price" class="block text-sm font-medium text-gray-700">Precio (‚Ç¨)</label>
                            <input type="number" id="product-price" class="mt-1 block w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="mt-8 text-right">
                        <button id="publish-product-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 disabled:bg-gray-400">Publicar</button>
                    </div>
                </div>
            </div>

            <!-- Coupons View -->
            <div id="view-coupons" class="view hidden">
                <h1 class="text-3xl font-bold mb-6">A√±adir nuevo cup√≥n</h1>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="space-y-6">
                        <div class="relative">
                            <label for="coupon-code" class="block text-sm font-medium text-gray-700">C√≥digo de cup√≥n</label>
                            <input type="text" id="coupon-code" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="relative">
                            <label for="coupon-discount" class="block text-sm font-medium text-gray-700">Importe del cup√≥n (%)</label>
                            <input type="number" id="coupon-discount" class="mt-1 block w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="mt-8 text-right">
                        <button id="create-coupon-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 disabled:bg-gray-400">Crear cup√≥n</button>
                    </div>
                </div>
            </div>

            <!-- Plugins View -->
            <div id="view-plugins" class="view hidden">
                <h1 class="text-3xl font-bold mb-6">A√±adir nuevo plugin</h1>
                 <div class="mb-6 relative">
                    <input type="text" id="plugin-search" placeholder="Buscar plugins..." class="w-1/2 px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div id="plugin-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Plugin card will be inserted here by JS -->
                </div>
            </div>
            
            <!-- Orders View -->
            <div id="view-orders" class="view hidden">
                 <h1 class="text-3xl font-bold mb-6">Pedidos</h1>
                 <div class="bg-white rounded-lg shadow-md overflow-hidden">
                     <table class="w-full">
                         <thead class="bg-gray-50">
                             <tr>
                                 <th class="p-4 text-left font-semibold text-gray-600">Pedido</th>
                                 <th class="p-4 text-left font-semibold text-gray-600">Cliente</th>
                                 <th class="p-4 text-left font-semibold text-gray-600">Fecha</th>
                                 <th class="p-4 text-left font-semibold text-gray-600">Estado</th>
                                 <th class="p-4 text-left font-semibold text-gray-600">Total</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr class="border-t">
                                 <td class="p-4 font-medium">#101</td>
                                 <td class="p-4 text-gray-600">Albus Dumbledore</td>
                                 <td class="p-4 text-gray-600">Hace 5 minutos</td>
                                 <td class="p-4">
                                     <select id="order-status" class="border border-gray-300 rounded-md p-1 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                         <option value="processing">Procesando</option>
                                         <option value="completed">Completado</option>
                                         <option value="cancelled">Cancelado</option>
                                     </select>
                                 </td>
                                 <td class="p-4 font-medium">‚Ç¨25.00</td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
            </div>

            <!-- Customize View -->
            <div id="view-customize" class="view hidden">
                <h1 class="text-3xl font-bold mb-6">Personalizar Tienda</h1>
                <div class="grid grid-cols-3 gap-8">
                    <div class="col-span-1 bg-white p-6 rounded-lg shadow-md">
                        <h2 class="text-xl font-semibold mb-4">Paleta de Colores</h2>
                        <p class="text-gray-600 mb-4">Elige un color para la cabecera de tu tienda.</p>
                        <div id="color-palette" class="flex space-x-4">
                             <div class="color-swatch w-12 h-12 rounded-full cursor-pointer bg-blue-800 border-2 border-transparent" data-color="bg-blue-800"></div>
                             <div class="color-swatch w-12 h-12 rounded-full cursor-pointer bg-red-800 border-2 border-transparent" data-color="bg-red-800"></div>
                             <div class="color-swatch w-12 h-12 rounded-full cursor-pointer bg-green-800 border-2 border-transparent" data-color="bg-green-800"></div>
                             <div class="color-swatch w-12 h-12 rounded-full cursor-pointer bg-yellow-500 border-2 border-transparent" data-color="bg-yellow-500"></div>
                        </div>
                    </div>
                    <div class="col-span-2">
                        <h2 class="text-xl font-semibold mb-4">Vista Previa</h2>
                        <div class="border-4 border-gray-300 rounded-lg">
                            <header id="store-preview-header" class="p-4 text-white font-bold transition-colors duration-300 bg-gray-800">
                                Mi Tienda M√°gica
                            </header>
                            <div class="bg-white p-8">
                                <h3 class="text-lg font-bold">Poci√≥n de Invisibilidad</h3>
                                <p class="text-gray-600">‚Ç¨25.00</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Tooltip Element -->
    <div id="tooltip" class="task-tooltip"></div>

    <!-- Modal -->
    <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm mx-auto">
            <div id="modal-icon" class="text-5xl mb-4">üéâ</div>
            <h2 id="modal-title" class="text-2xl font-bold mb-2">¬°Misi√≥n Completada!</h2>
            <p id="modal-message" class="text-gray-600 mb-6">Has creado tu primer producto. ¬°Excelente trabajo!</p>
            <button id="modal-close-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Siguiente Misi√≥n</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game state
            const state = {
                missions: {
                    1: false,
                    2: false,
                    3: false,
                    4: false,
                    5: false,
                },
                currentMission: 1,
            };

            // DOM Elements
            const views = document.querySelectorAll('.view');
            const navLinks = document.querySelectorAll('.nav-link');
            const tooltip = document.getElementById('tooltip');
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modalIcon = document.getElementById('modal-icon');
            const modalCloseBtn = document.getElementById('modal-close-btn');

            // Mission 1 Elements
            const productNameInput = document.getElementById('product-name');
            const productDescInput = document.getElementById('product-description');
            const productPriceInput = document.getElementById('product-price');
            const publishProductBtn = document.getElementById('publish-product-btn');

            // Mission 2 Elements
            const couponCodeInput = document.getElementById('coupon-code');
            const couponDiscountInput = document.getElementById('coupon-discount');
            const createCouponBtn = document.getElementById('create-coupon-btn');

            // Mission 3 Elements
            const pluginSearchInput = document.getElementById('plugin-search');
            const pluginList = document.getElementById('plugin-list');

            // Mission 4 Elements
            const orderStatusSelect = document.getElementById('order-status');
            
            // Mission 5 Elements
            const colorPalette = document.getElementById('color-palette');
            const storePreviewHeader = document.getElementById('store-preview-header');

            // --- UTILITY FUNCTIONS ---
            
            function showView(viewId) {
                views.forEach(view => view.classList.add('hidden'));
                document.getElementById(`view-${viewId}`).classList.remove('hidden');

                navLinks.forEach(link => link.classList.remove('bg-gray-900'));
                document.getElementById(`nav-${viewId}`).classList.add('bg-gray-900');
            }
            
            function showTooltip(element, text) {
                if (!element) return;
                const rect = element.getBoundingClientRect();
                tooltip.style.top = `${rect.top + rect.height / 2 - tooltip.offsetHeight / 2}px`;
                tooltip.style.left = `${rect.right + 15}px`;
                tooltip.textContent = text;
                tooltip.classList.add('visible');
                element.classList.add('highlight-focus');
            }

            function hideTooltip() {
                tooltip.classList.remove('visible');
                document.querySelectorAll('.highlight-focus').forEach(el => el.classList.remove('highlight-focus'));
            }

            function showModal(title, message, icon) {
                modalTitle.textContent = title;
                modalMessage.textContent = message;
                modalIcon.textContent = icon;
                modal.classList.remove('hidden');
            }

            function completeMission(missionNumber) {
                if (state.missions[missionNumber]) return; // Already completed

                state.missions[missionNumber] = true;
                const missionItem = document.getElementById(`mission-${missionNumber}`);
                missionItem.classList.add('completed');
                missionItem.classList.remove('active');

                // Find next mission
                const nextMission = Object.keys(state.missions).find(m => !state.missions[m]);
                if (nextMission) {
                    state.currentMission = parseInt(nextMission);
                    document.getElementById(`mission-${state.currentMission}`).classList.add('active');
                } else {
                    state.currentMission = null; // All completed
                }
                updateUIForCurrentMission();
            }
            
            function updateUIForCurrentMission() {
                hideTooltip();
                switch(state.currentMission) {
                    case 1:
                        showView('products');
                        showTooltip(productNameInput, 'Escribe "Poci√≥n de Invisibilidad" aqu√≠.');
                        break;
                    case 2:
                        showView('coupons');
                        showTooltip(couponCodeInput, 'Inventa un c√≥digo, como "MAGIA10".');
                        break;
                    case 3:
                        showView('plugins');
                        showTooltip(pluginSearchInput, 'Busca "opiniones" para encontrar un plugin de rese√±as.');
                        break;
                    case 4:
                        showView('orders');
                        showTooltip(orderStatusSelect, 'Cambia el estado a "Completado".');
                        break;
                    case 5:
                        showView('customize');
                        showTooltip(colorPalette.children[0], 'Haz clic en un color para cambiar el dise√±o.');
                        break;
                    default:
                        showView('dashboard');
                }
            }

            // --- MISSION LOGIC ---

            // Mission 1: Create Product
            function setupMission1() {
                const checkCompletion = () => {
                    const isComplete = productNameInput.value.trim() !== '' && productDescInput.value.trim() !== '' && productPriceInput.value.trim() !== '';
                    publishProductBtn.disabled = !isComplete;
                };

                [productNameInput, productDescInput, productPriceInput].forEach(input => {
                    input.addEventListener('input', () => {
                        checkCompletion();
                        if (input === productNameInput && input.value.trim() !== '') {
                            showTooltip(productDescInput, '¬°Genial! Ahora a√±ade una descripci√≥n.');
                        } else if (input === productDescInput && input.value.trim() !== '') {
                            showTooltip(productPriceInput, 'Perfecto. Solo falta el precio.');
                        } else if (input === productPriceInput && input.value.trim() !== '') {
                           hideTooltip();
                           publishProductBtn.classList.add('highlight-focus');
                        }
                    });
                });
                
                publishProductBtn.addEventListener('click', () => {
                    if (publishProductBtn.disabled) return;
                    completeMission(1);
                    showModal('¬°Misi√≥n 1 Completada!', 'Has creado tu primer producto m√°gico. ¬°Los clientes vendr√°n en masa!', 'üì¶');
                });
            }

            // Mission 2: Create Coupon
            function setupMission2() {
                const checkCompletion = () => {
                    createCouponBtn.disabled = !(couponCodeInput.value.trim() && couponDiscountInput.value.trim());
                };
                [couponCodeInput, couponDiscountInput].forEach(input => {
                    input.addEventListener('input', () => {
                        checkCompletion();
                        if (input === couponCodeInput && input.value.trim()) {
                            showTooltip(couponDiscountInput, 'Ahora, define el porcentaje de descuento.');
                        } else if (input === couponDiscountInput && input.value.trim()){
                            hideTooltip();
                            createCouponBtn.classList.add('highlight-focus');
                        }
                    });
                });
                createCouponBtn.addEventListener('click', () => {
                    if(createCouponBtn.disabled) return;
                    completeMission(2);
                    showModal('¬°Misi√≥n 2 Completada!', '¬°Una oferta irresistible! Los magos y brujas har√°n cola.', 'üè∑Ô∏è');
                });
            }

            // Mission 3: Install Plugin
            function setupMission3() {
                pluginSearchInput.addEventListener('input', () => {
                    if (pluginSearchInput.value.toLowerCase().includes('opiniones')) {
                        hideTooltip();
                        pluginList.innerHTML = `
                            <div class="bg-white p-4 rounded-lg shadow-md border">
                                <h3 class="font-bold text-lg">Opiniones con Estrellas Brillantes</h3>
                                <p class="text-sm text-gray-600 my-2">Permite que tus clientes dejen rese√±as m√°gicas en tus productos.</p>
                                <button id="install-plugin-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">Instalar ahora</button>
                            </div>
                        `;
                        const installBtn = document.getElementById('install-plugin-btn');
                        installBtn.classList.add('highlight-focus');
                        installBtn.addEventListener('click', () => {
                            installBtn.textContent = 'Instalando...';
                            installBtn.disabled = true;
                            setTimeout(() => {
                                installBtn.textContent = 'Activando...';
                                setTimeout(() => {
                                    installBtn.textContent = '¬°Activado!';
                                    installBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                                    installBtn.classList.add('bg-green-600');
                                    completeMission(3);
                                    showModal('¬°Misi√≥n 3 Completada!', 'Tu tienda ahora tiene el poder de las opiniones. ¬°M√°s confianza, m√°s ventas!', 'üåü');
                                }, 1000);
                            }, 1500);
                        });
                    } else {
                        pluginList.innerHTML = '';
                    }
                });
            }
            
            // Mission 4: Process Order
            function setupMission4() {
                orderStatusSelect.addEventListener('change', () => {
                    if(orderStatusSelect.value === 'completed') {
                        hideTooltip();
                        completeMission(4);
                        showModal('¬°Misi√≥n 4 Completada!', '¬°Pedido enviado! Albus Dumbledore estar√° encantado con su compra.', 'üöö');
                    }
                });
            }
            
            // Mission 5: Customize Store
            function setupMission5() {
                const swatches = document.querySelectorAll('.color-swatch');
                swatches.forEach(swatch => {
                    swatch.addEventListener('click', () => {
                        // Remove previous classes
                        const colorClasses = Array.from(storePreviewHeader.classList).filter(c => c.startsWith('bg-'));
                        storePreviewHeader.classList.remove(...colorClasses);
                        // Add new class
                        storePreviewHeader.classList.add(swatch.dataset.color);
                        
                        // Highlight selected swatch
                        swatches.forEach(s => s.classList.remove('border-blue-500'));
                        swatch.classList.add('border-blue-500');

                        if (!state.missions[5]) {
                            hideTooltip();
                            completeMission(5);
                             showModal('¬°Todas las Misiones Completadas!', '¬°Felicidades! Has dominado los secretos de WooCommerce. Tu tienda m√°gica est√° lista para el √©xito.', 'üèÜ');
                        }
                    });
                });
            }

            // --- EVENT LISTENERS ---
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const viewId = e.currentTarget.id.replace('nav-', '');
                    showView(viewId);
                });
            });
            
            modalCloseBtn.addEventListener('click', () => {
                modal.classList.add('hidden');
                if (state.currentMission) {
                    updateUIForCurrentMission();
                } else {
                    showView('dashboard');
                }
            });

            // --- INITIALIZATION ---
            function init() {
                showView('dashboard');
                setupMission1();
                setupMission2();
                setupMission3();
                setupMission4();
                setupMission5();
                
                // Disable buttons initially
                publishProductBtn.disabled = true;
                createCouponBtn.disabled = true;
            }

            init();
        });
    </script>
</body>
</html>
